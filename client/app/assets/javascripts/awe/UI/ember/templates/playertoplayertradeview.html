<script type="text/x-handlebars" data-template-name="player-to-player-trade-view">
  
  <h2>{{t settlement.trade.sendResources}}</h2>
    
  <p>{{t settlement.trade.cartsEnRoute}}: {{ settlement.trading_carts_used }} / {{ settlement.trading_carts }}</p>
  
  <p>{{t settlement.trade.recipient}}: {{view Ember.TextField class="text-field" placeholder="Spielername" valueBinding="recipientName"}}</p>

  <p>
    {{#each resources}}
      {{local type.name}}: {{view Ember.TextField class="text-field resource-amount" placeholder="Menge" valueBinding="amount"}}
    {{/each}}
  </p>  

  {{#if errorMessage}}<p class="red-color"><b>{{errorMessage}}</b></p>{{/if}}
    
  {{#if sending}}
    <p>{{view AWE.UI.Ember.WheelOrValueView valueBinding="false"}} {{t general.processing}}</p>
  {{else}}
    <p><span class="simple-button clickable" {{bindAttr class="inactive impossible"}} {{action "sendPressed"}}>{{t settlement.trade.send}} {{numCarts}} {{t building.tradingCarts}}</span></p>
  {{/if}}
  
  <hr/>
  
  <h2>{{t settlement.trade.enRoute}}</h2>
  <table>
    {{#if settlement.enumerableOutgoingTradingCartActions}}
      <tr><th>{{t settlement.trade.carts}}</th><th>{{t settlement.trade.destination}}</th><th>{{t settlement.trade.timeOfArrival}}</th></tr>
      {{#each settlement.enumerableOutgoingTradingCartActions}}
        {{view AWE.UI.Ember.TradingCartActionView settlementBinding="view.settlement" tradingCartActionBinding="this"}}
      {{/each}}
    {{else}}
      <tr>
        <td colspan="4">{{t settlement.trade.noCartsInTransit}}</td>
      </tr>
    {{/if}}
  </table>
  
  <h2>{{t settlement.trade.inbound}}</h2>
  <table>
    {{#if settlement.enumerableIncomingTradingCartActions}}
      <tr><th>{{t settlement.trade.carts}}</th><th>{{t settlement.trade.origin}}</th><th>{{t settlement.trade.timeOfArrival}}</th></tr>
      {{#each settlement.enumerableIncomingTradingCartActions}}
        {{view AWE.UI.Ember.TradingCartActionView settlementBinding="view.settlement" tradingCartActionBinding="this"}}
      {{else}}
      {{/each}}
    {{else}}
      <tr>
        <td colspan="4">{{t settlement.trade.noCartsInTransit}}</td>
      </tr>
    {{/if}}
  </table>
  
</script>



<script type="text/x-handlebars" data-template-name="resources-amount-view">
  {{#each resources}}
    <span class="resource-icon {{unbound resourceType.symbolic_id}}">&nbsp;</span> {{formatNumber amount maxPlaces="0"}} &nbsp;
  {{/each}}
</script>


<script type="text/x-handlebars" data-template-name="trading-cart-action-view">
  <tr>
    <td>{{tradingCartAction.num_carts}}</td>
    <td>
      {{#if tradingCartAction.returning}}
        {{#if outgoing}}
          {{t settlement.trade.returnFrom}} {{view AWE.UI.Ember.WheelOrValueView valueBinding="targetSettlement.name"}} 
          ({{view AWE.UI.Ember.LinkedCharacterView characterBinding="recipient"}})
        {{else}}
          {{t settlement.trade.returnTo}} {{view AWE.UI.Ember.WheelOrValueView valueBinding="startingSettlement.name"}} 
          ({{view AWE.UI.Ember.LinkedCharacterView characterBinding="sender"}})
        {{/if}}
      {{else}}
        {{#if outgoing}}
          {{view AWE.UI.Ember.WheelOrValueView valueBinding="targetSettlement.name"}} 
          ({{view AWE.UI.Ember.LinkedCharacterView characterBinding="recipient"}})          
        {{else}}
          {{view AWE.UI.Ember.WheelOrValueView valueBinding="startingSettlement.name"}} 
          ({{view AWE.UI.Ember.LinkedCharacterView characterBinding="sender"}})                    
        {{/if}}
      {{/if}}
    </td>
    <td>
      {{#if tradingCartAction.returning}}
        {{formatTime tradingCartAction.returned_at}}
      {{else}}
        {{formatTime tradingCartAction.target_reached_at}}
        {{#if cancelable}}
          {{#if sending}}
            {{view AWE.UI.Ember.WheelOrValueView valueBinding="false"}} {{t settlement.trade.sending}}...
          {{else}}
            <span class="simple-button clickable" {{action "cancelPressed"}}>{{t general.cancel}}</span>
          {{/if}}
        {{/if}}
      {{/if}}
    </td>
    <td>
      {{#if hurrying}}
        {{view AWE.UI.Ember.WheelOrValueView valueBinding="false"}} {{t settlement.trade.sending}}...
      {{else}}
        <span class="simple-button clickable" {{action "speedupPressed"}} {{bindAttr title="speedupTooltipText"}}>ement.trade.hurry}} {{speedupCosts}}
          <span class="resource-icon resource_cash">&nbsp;</span>
        </span -->
      {{/if}}
    </td>
  </tr>
  <tr>
    <td></td>
    <td colspan="2">{{#if empty}} <em>{{t settlement.trade.empty}}</em> {{else}} {{t settlement.trade.cargo}}: {{view Ember.View templateName="resources-amount-view" resourcesBinding="load" classNames="inline"}} {{/if}}</td>
  </tr>
</script>


