<script type="text/x-handlebars" data-template-name="assignment-list-view">


  <h3>{{t settlement.assignment.specialAssignments}}</h3>
  {{#if specialAssignment}}
    {{view AWE.UI.Ember.SpecialAssignmentView specialAssignmentBinding="specialAssignment" controllerBinding="controller" }}
  {{else}}
  <p>{{t settlement.assignment.noneSpecialAvailable}}</p>
  {{/if}}

  <h3>{{t settlement.assignment.assignments}}</h3>
  {{#if assignmentTypes}}
    {{#each assignmentTypes }}
      {{view AWE.UI.Ember.AssignmentView assignmentTypeBinding="this" controllerBinding="controller" }}
    {{/each}}
  {{else}}
    <p>{{t settlement.assignment.noneAvailable}}</p>
  {{/if}}

  <a href="#" onClick="AWE.UI.Ember.AssignmentsDialog.create().open()">Details</a>
</script>


<script type="text/x-handlebars" data-template-name="assignment-view">

<div {{bindAttr class=":stone-panel :standard-assignment :clickable assignmentType.advisor"}} {{action "togglePressed"}}>

  <table class="assignment-collapse-table">
    <tr>
      <td class="assignment-header-cell">
        <div class="assignment-icon">
          <div {{bindAttr class="assignmentType.advisor"}}></div>
        </div>
        {{local assignmentType.name}}
      </td>
      <td class="assignment-progress-cell">
        {{#if isActive }}
          <div class="duration assignment-progress-bar-border">
            <div class="assignment-progress-bar" {{bindAttr style="progressBarWidth"}}>
              {{#if finished}}
                {{t settlement.assignment.finishing}}
              {{else}}
                {{formatDuration timeRemaining}}
              {{/if}}
            </div>
          </div>
        {{/if}}
      </td>
      <td style="position:relative" class="assignment-button-cell">
        {{#if isActive }}
          {{#unless isHalved }}
            {{#if halving }}
              {{view AWE.UI.Ember.WheelOrValueView valueBinding="false"}} {{t general.processing}}
            {{else}}
              <span class="simple-button clickable" {{action "speedupPressed"}} {{bindAttr title="speedupTooltipText"}}>
                {{t settlement.assignment.hurry}} {{speedupCosts}}
                <span class="resource-icon resource_cash">&nbsp;</span>&nbsp;
              </span>
            {{/if}}
          {{/unless }}
        {{else}}
          {{#if starting }}
            {{view AWE.UI.Ember.WheelOrValueView valueBinding="false"}} {{t general.processing}}
          {{else}}
            <span class="simple-button clickable" {{action "startPressed"}}>{{t settlement.assignment.start}}</span>
            {{#if uiMarker}}
              {{view AWE.UI.Ember.UIMarker direction=1 top="-37" left="-3"}}
            {{/if}}
          {{/if}}
        {{/if}}
      </td>
    </tr>
  </table>

  {{#unless collapsed}}

    <div class="clearfix">
      <div {{bindAttr class=":advisor assignmentType.advisor"}}></div>
      <p>{{local assignmentType.description}}</p>
    </div>
    
    
    <div class="assignment-details">

      {{t settlement.assignment.duration}}: {{formatDuration duration}}
        {{#if isHalved }}
          ({{t settlement.assignment.hurried }})
        {{/if}} <br />
      {{#if assignmentType.costs}}
        {{t settlement.assignment.costs}}:
        {{#each costs}}
          <span class="resource-icon {{unbound resourceType.symbolic_id}}" {{bindAttr title="{{local resourceType.name}}"}}>&nbsp;</span> {{amount}} &nbsp;
        {{/each}}
        <br />
      {{/if}}
      {{#if assignmentType.unit_deposits}}
        {{t settlement.assignment.unitDeposits}}:
          {{#each unitDeposits}}
            <span class="unit-icon {{unbound unitType.symbolic_id}}" {{bindAttr title="{{local unitType.name}}"}}>&nbsp;</span> {{local unitType.name}} {{amount}} &nbsp;
          {{/each}}
        <br />
      {{/if}}
      {{#if assignmentType.rewards}}
        {{t settlement.assignment.rewards}}:
          {{#each resourceRewards}}
            <span class="resource-icon {{unbound resourceType.symbolic_id}}" {{bindAttr title="{{local resourceType.name}}"}}>&nbsp;</span> {{amount}} &nbsp;
          {{/each}}
          {{#each unitRewards}}
            <span class="unit-icon {{unbound unitType.symbolic_id}}" {{bindAttr title="{{local unitType.name}}"}}>&nbsp;</span> {{local unitType.name}} {{amount}} &nbsp;
          {{/each}}
          {{#if assignmentType.rewards.experience_reward }}
            <span class="xp-icon" title="XP">&nbsp;</span> {{assignmentType.rewards.experience_reward}} &nbsp;
          {{/if }}
      {{/if}}

      <div class="clickable up-icon" {{bindAttr title="settlement.assignment.collapse"}}> </div>
  
    </div>
  
  {{/unless}}

</div>
</script>




<script type="text/x-handlebars" data-template-name="special-assignment-view">

<div {{bindAttr class=":stone-panel :standard-assignment :clickable assignmentType.advisor"}} {{action "togglePressed"}}>

  <table class="assignment-collapse-table">
    <tr>
      <td class="assignment-header-cell">
      <div class="assignment-icon">
        <div {{bindAttr class="assignmentType.advisor"}}></div>
      </div>
        {{local assignmentType.name}}</td>
      <td class="assignment-progress-cell">
        {{#if isActive }}
          <div class="duration assignment-progress-bar-border">
            <div class="assignment-progress-bar" {{bindAttr style="progressBarWidth"}}>
              {{#if finished}}
                {{t settlement.assignment.finishing}}
              {{else}}
                {{formatDuration timeRemaining}}
              {{/if}}
            </div>
          </div>
        {{/if}}
      </td>
      <td class="assignment-button-cell">
        {{#if isActive }}
          {{#unless isHalved }}
            {{#if halving }}
              {{view AWE.UI.Ember.WheelOrValueView valueBinding="false"}} {{t general.processing}}
            {{else}}
              <span class="simple-button clickable" {{action "speedupPressed"}} {{bindAttr title="speedupTooltipText"}}>
                {{t settlement.assignment.hurry}} {{speedupCosts}}
                <span class="resource-icon resource_cash">&nbsp;</span>&nbsp;
              </span>
            {{/if}}
          {{/unless }}
        {{else}}
          {{#if starting }}
            {{view AWE.UI.Ember.WheelOrValueView valueBinding="false"}} {{t general.processing}}
          {{else}}
            <span class="simple-button clickable" {{action "startPressed"}}>{{t settlement.assignment.start}}</span>
          {{/if}}
        {{/if}}
      </td>
    </tr>
  </table>

  {{#unless collapsed}}

    <div class="clearfix">
      <div {{bindAttr class=":advisor assignmentType.advisor"}}></div>
      <p>{{local assignmentType.description}}</p>
    </div>

    <div class="assignment-details">

      {{t settlement.assignment.duration}}: {{formatDuration duration}}
        {{#if isHalved }}
          ({{t settlement.assignment.hurried }})
        {{/if}} <br />
      {{t settlement.assignment.costs}}:
      {{#if costs}}
        {{#each costs}}
          <span class="resource-icon {{unbound resourceType.symbolic_id}}" {{bindAttr title="{{local resourceType.name}}"}}>&nbsp;</span> {{amount}} &nbsp;
        {{/each}}
        <br />
      {{/if}}
      {{#if unitDeposits}}
        {{t settlement.assignment.unitDeposits}}:
          {{#each unitDeposits}}
            <span class="unit-icon {{unbound unitType.symbolic_id}}" {{bindAttr title="{{local unitType.name}}"}}>&nbsp;</span> {{local unitType.name}} {{amount}} &nbsp;
          {{/each}}
        <br />
      {{/if}}
        {{t settlement.assignment.rewards}}:
        {{#each resourceRewards}}
          <span class="resource-icon {{unbound resourceType.symbolic_id}}" {{bindAttr title="{{local resourceType.name}}"}}>&nbsp;</span> {{amount}} &nbsp;
        {{/each}}
        {{#each unitRewards}}
          <span class="unit-icon {{unbound unitType.symbolic_id}}" {{bindAttr title="{{local unitType.name}}"}}>&nbsp;</span> {{local unitType.name}} {{amount}} &nbsp;
        {{/each}}
        {{#if settlement.assignment.experience_reward }}
          <span class="xp-icon" title="XP">&nbsp;</span> {{assignmentType.rewards.experience_reward}} &nbsp;
        {{/if }}

        <div class="clickable up-icon" {{bindAttr title="settlement.assignment.collapse"}}> </div>

    </div>

    
  {{/unless}}


</div>
</script>
